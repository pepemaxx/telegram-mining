<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PiNet – Daily Mining Clicker</title>
<style>
/* ====== Theme ====== */
:root{
  --bg1:#4c1d95;
  --bg2:#7b2cbf;
  --ink:#fff;
  --btn-bg:#a855f7;
  --btn-hover:#9333ea;
}
body {
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,var(--bg1),var(--bg2));
  color: var(--ink);
}
.container{
  max-width: 500px;
  margin: auto;
  padding: 20px;
}
button{
  background-color: var(--btn-bg);
  border:none;
  padding: 10px 20px;
  color: var(--ink);
  cursor:pointer;
  border-radius: 8px;
  margin: 5px 0;
}
button:hover{
  background-color: var(--btn-hover);
}
button:disabled{
  background-color: #555;
  cursor: not-allowed;
}
.section{
  background: rgba(255,255,255,0.1);
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 10px;
}
h2{
  margin-top:0;
}
</style>
</head>
<body>
<div class="container">

  <!-- Mining Section -->
  <div class="section" id="mining-section">
    <h2>ماینینگ روزانه</h2>
    <p id="mining-status">وضعیت: آماده</p>
    <p id="mining-timer">زمان باقی مانده: 24:00:00</p>
    <button id="claim-btn" disabled>Claim</button>
  </div>

  <!-- Manual Mining Section -->
  <div class="section">
    <h2>ماینینگ دستی</h2>
    <p id="manual-status">Ready</p>
    <button id="manual-btn">Mine +0.5 Coin</button>
  </div>

  <!-- Referral Section -->
  <div class="section">
    <h2>رفرال</h2>
    <p>لینک شما: <span id="referral-link"></span></p>
  </div>

  <!-- Wallet Section -->
  <div class="section">
    <h2>کیف پول</h2>
    <p>Coins: <span id="wallet-coins">0</span></p>
    <p>Pi: <span id="wallet-pi">0</span></p>
    <p>USDT: <span id="wallet-usdt">0</span></p>
  </div>

</div>

<script>
// ================================
// ====== Persistent State ========
// ================================
const state = JSON.parse(localStorage.getItem('state')) || {
  coins:0,
  pi:0,
  usdt:0,
  miningStart: null,
  referral: null
};

// ================================
// ====== Utility Functions =======
// ================================
function saveState(){
  localStorage.setItem('state', JSON.stringify(state));
}

function formatTime(seconds){
  const h=Math.floor(seconds/3600);
  const m=Math.floor((seconds%3600)/60);
  const s=seconds%60;
  return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}

// ================================
// ====== Mining Logic =============
// ================================
let tickId = null;
const MINING_DURATION = 24*60*60; // 24 ساعت به ثانیه
const claimBtn = document.getElementById('claim-btn');
const miningStatus = document.getElementById('mining-status');
const miningTimer = document.getElementById('mining-timer');

function getRemainingMiningTime(){
  if(!state.miningStart) return MINING_DURATION;
  const elapsed = Math.floor((Date.now() - state.miningStart)/1000);
  return Math.max(MINING_DURATION - elapsed,0);
}

function updateMiningUI(){
  const remaining = getRemainingMiningTime();
  miningTimer.textContent = `زمان باقی مانده: ${formatTime(remaining)}`;
  if(remaining <= 0){
    miningStatus.textContent = 'Completed – claim pending';
    claimBtn.disabled = false;
    clearInterval(tickId);
    tickId = null;
  } else {
    miningStatus.textContent = 'In Progress';
    claimBtn.disabled = true;
  }
}

function runTick(){
  if(tickId) clearInterval(tickId);
  tickId = setInterval(updateMiningUI,1000);
  updateMiningUI();
}

// Start mining if not started
if(!state.miningStart){
  state.miningStart = Date.now();
  saveState();
}
runTick();

claimBtn.addEventListener('click',()=>{
  if(getRemainingMiningTime()>0) return alert('تایمر هنوز تمام نشده.');
  state.coins += 10; // پاداش Claim
  state.miningStart = Date.now(); // Reset for next mining
  saveState();
  runTick();
  alert('Claim با موفقیت انجام شد!');
});

// ================================
// ====== Manual Mining ============
// ================================
const manualBtn = document.getElementById('manual-btn');
const manualStatus = document.getElementById('manual-status');
let manualCooldown = false;

manualBtn.addEventListener('click',()=>{
  if(manualCooldown) return alert('در حال cooldown، کمی صبر کنید.');
  state.coins += 0.5;
  saveState();
  updateWalletUI();
  manualStatus.textContent = 'Success! +0.5 Coin';
  manualCooldown = true;
  setTimeout(()=>{manualCooldown=false; manualStatus.textContent='Ready';},10000);
});

// ================================
// ====== Referral Logic ===========
// ================================
const referralLinkEl = document.getElementById('referral-link');
if(!state.referral){
  state.referral = 'ref-' + Math.random().toString(36).slice(2,8);
  saveState();
}
referralLinkEl.textContent = state.referral;

// ================================
// ====== Wallet UI ================
// ================================
const walletCoins = document.getElementById('wallet-coins');
const walletPi = document.getElementById('wallet-pi');
const walletUsdt = document.getElementById('wallet-usdt');

function updateWalletUI(){
  walletCoins.textContent = state.coins.toFixed(2);
  walletPi.textContent = state.pi.toFixed(2);
  walletUsdt.textContent = state.usdt.toFixed(2);
}
updateWalletUI();

</script>
</body>
</html>