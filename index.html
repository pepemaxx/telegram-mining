<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PiNet — Daily Mining</title>
  <style>
    :root{
      --bg1:#5a189a; --bg2:#7b2cbf; --ink:#ffffff; --muted:#e2e8f0; --card:rgba(0,0,0,.22);
      --brand:#f1c40f; --border:rgba(255,255,255,.2);
      --good:#10b981; --warn:#f59e0b;
    }
    body{margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--ink);
      font-family:Inter, Segoe UI, Roboto, system-ui, -apple-system, sans-serif;height:100vh;overflow:hidden;}
    #app{position:relative;z-index:1;height:100%;display:flex;flex-direction:column}
    main{flex:1;overflow-y:auto;padding:16px 16px 96px;max-width:820px;margin:0 auto}

    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px 16px;box-shadow:0 6px 24px rgba(0,0,0,.15);margin-top:12px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .muted{color:var(--muted);font-size:12px}
    .big{font-size:28px;font-weight:800}
    .pill{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,.06)}
    .pill.good{background:rgba(16,185,129,.15);color:#d1fae5;border-color:rgba(16,185,129,.4)}
    .pill.warn{background:rgba(245,158,11,.14);color:#fff;border-color:rgba(245,158,11,.45)}
    .progress{height:10px;border-radius:999px;background:rgba(255,255,255,.18);overflow:hidden}
    .progress>div{height:100%;background:var(--brand);transition:width .25s}
    .btn{border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .btn-gold{background:var(--brand);color:#4c1d95}
    .btn-ghost{background:rgba(255,255,255,.12);color:#fff;border:1px solid var(--border)}
  </style>
</head>
<body>
  <div id="app">
    <main>
      <!-- Mining -->
      <section class="tab active" id="tab-mining">
        <div class="card row">
          <div>
            <div class="muted">Wallet Balance</div>
            <div class="big"><span id="balance">0</span> <span class="muted" style="font-size:14px">Coins</span></div>
          </div>
          <div style="text-align:end">
            <div class="muted">Mining Status</div>
            <div id="miningStatus" class="pill">Inactive</div>
          </div>
        </div>

        <div class="card">
          <div class="row" style="align-items:flex-end">
            <div>
              <div class="muted">Time Remaining</div>
              <div id="timer" class="big">00:00:00</div>
            </div>
            <div style="text-align:end">
              <div class="muted">This Session Earnings</div>
              <div class="big" style="color:var(--brand)"><span id="sessionEarnings">0</span> Coins</div>
            </div>
          </div>
          <div class="progress" style="margin-top:10px"><div id="progressBar" style="width:0%"></div></div>
          <div class="row" style="margin-top:12px">
            <button id="startBtn" class="btn btn-gold">Start 5h Mining</button>
            <button id="claimBtn" class="btn btn-ghost" disabled>Finish & Claim</button>
          </div>
          <div class="muted" style="margin-top:8px">Rate: <span id="rateText">0</span> coins/sec • Progress is saved even if you close the app.</div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const DURATION_MS = 5 * 60 * 60 * 1000; // 5 hours
    const RATE_PER_SEC = 0.05;
    const STORAGE_KEY = 'pinet_clicker_state_v2';

    function initState(){
      const saved = load();
      if(saved) return saved;
      return { coins: 0, miningStart: null };
    }
    const state = initState();

    const balanceEl = document.getElementById('balance');
    const miningStatusEl = document.getElementById('miningStatus');
    const timerEl = document.getElementById('timer');
    const sessionEarningsEl = document.getElementById('sessionEarnings');
    const progressBarEl = document.getElementById('progressBar');
    const startBtn = document.getElementById('startBtn');
    const claimBtn = document.getElementById('claimBtn');
    const rateText = document.getElementById('rateText');

    rateText.textContent = RATE_PER_SEC.toString();

    let tickId = null;

    function setupMining(){
      updateUI();
      startBtn.addEventListener('click',()=>{
        if(state.miningStart) return;
        state.miningStart = Date.now();
        save();
        updateUI();
        runTick();
      });
      claimBtn.addEventListener('click', finalizeMining);

      if(state.miningStart){
        const {remaining} = metrics();
        if(remaining>0){ runTick(); } else { finalizeMining(); }
      }
    }

    function runTick(){
      clearInterval(tickId);
      tick();
      tickId = setInterval(tick, 1000);
    }

    function metrics(){
      if(!state.miningStart) return {elapsed:0, remaining:0, progress:0, rewardNow:0};
      const now = Date.now();
      const elapsed = Math.max(0, now - state.miningStart);
      const remaining = Math.max(0, DURATION_MS - elapsed);
      const clamped = Math.min(elapsed, DURATION_MS);
      const rewardNow = (clamped/1000) * RATE_PER_SEC;
      const progress = (clamped / DURATION_MS) * 100;
      return {elapsed, remaining, progress, rewardNow};
    }

    function formatHHMMSS(ms){
      const s = Math.max(0, Math.floor(ms/1000));
      const h = String(Math.floor(s/3600)).padStart(2,'0');
      const m = String(Math.floor((s%3600)/60)).padStart(2,'0');
      const ss = String(s%60).padStart(2,'0');
      return `${h}:${m}:${ss}`;
    }

    function tick(){
      const {remaining, progress, rewardNow} = metrics();
      timerEl.textContent = formatHHMMSS(remaining);
      sessionEarningsEl.textContent = rewardNow.toFixed(2);
      progressBarEl.style.width = `${progress}%`;

      if(remaining<=0){
        clearInterval(tickId); tickId=null;
        claimBtn.disabled = false;
        miningStatusEl.textContent = 'Completed — Claim Now';
        miningStatusEl.className = 'pill warn';
      }
    }

    function finalizeMining(){
      if(!state.miningStart) return;
      const {rewardNow} = metrics();
      if(rewardNow>0){
        state.coins += rewardNow;
      }
      state.miningStart = null;
      save();
      updateUI();
    }

    function updateUI(){
      balanceEl.textContent = Math.floor(state.coins);
      if(state.miningStart){
        startBtn.disabled = true; claimBtn.disabled = true;
        miningStatusEl.textContent = 'Active';
        miningStatusEl.className = 'pill good';
        const {remaining, progress, rewardNow} = metrics();
        timerEl.textContent = formatHHMMSS(remaining);
        sessionEarningsEl.textContent = rewardNow.toFixed(2);
        progressBarEl.style.width = `${progress}%`;
      }else{
        startBtn.disabled = false; claimBtn.disabled = true;
        miningStatusEl.textContent = 'Inactive';
        miningStatusEl.className = 'pill';
        timerEl.textContent = '00:00:00';
        sessionEarningsEl.textContent = '0';
        progressBarEl.style.width = '0%';
      }
    }

    function load(){ try{return JSON.parse(localStorage.getItem(STORAGE_KEY));}catch(e){return null;} }
    function save(){ try{localStorage.setItem(STORAGE_KEY, JSON.stringify(state));}catch(e){} }

    setupMining();
  </script>
</body>
</html>